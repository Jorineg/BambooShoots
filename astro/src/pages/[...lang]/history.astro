---
import Layout from '../../layouts/Layout.astro';
import { getLocale, t, localizedUrl, defaultLocale } from '../../lib/i18n';
import { getHistoryPage, getTimelineEvents } from '../../lib/sanity';

export async function getStaticPaths() {
  return [
    { params: { lang: undefined } },
    { params: { lang: 'en' } },
    { params: { lang: 'kh' } },
  ];
}

const { lang } = Astro.params;
const locale = lang as any || defaultLocale;

const historyPage = await getHistoryPage();
const timelineEvents = await getTimelineEvents();

const pageTitle = locale === 'de' 
  ? 'Geschichte' 
  : locale === 'en' 
  ? 'History' 
  : 'á”áŸ’ášáœááŸ’áá·';

// Default timeline events
const defaultEvents = [
  { year: '2003', title: { de: 'Erste Vorschule & Kids Club in Kok Kryll', en: 'First preschool & kids club in Kok Kryll', kh: 'á˜ááŸ’ááŸá™áŸ’á™áŠáŸ†á”á¼á„ á“á·á„á€áŸ’á›á·á”á€á»á˜á¶ášá“áŸ… Kok Kryll' }},
  { year: '2005', title: { de: 'Ausbau & Erweiterung: Weiterer Standort Liang Dai', en: 'Expansion: Additional location Liang Dai', kh: 'á–á„áŸ’ášá¸á€áŸ– á‘á¸áá¶áŸ†á„á”á“áŸ’ááŸ‚á˜ Liang Dai' }},
  { year: '2006', title: { de: 'Offizielle NGO-GrÃ¼ndung Bamboo Shoots â€“ Time to Grow', en: 'Official NGO founding of Bamboo Shoots', kh: 'á€á¶ášá”á„áŸ’á€á¾áá•áŸ’á›á¼áœá€á¶ášášá”áŸáŸ‹ Bamboo Shoots' }},
  { year: '2008', title: { de: 'Bibliothek erÃ¶ffnet in Phum Prasat', en: 'Library opens in Phum Prasat', kh: 'á”ááŸ’áá¶á›áŸá™á”á¾á€á“áŸ… Phum Prasat' }},
  { year: '2009', title: { de: '3. Vorschule gebaut in Rokar Yea', en: '3rd preschool built in Rokar Yea', kh: 'á˜ááŸ’ááŸá™áŸ’á™á‘á¸ 3 áŸá¶á„áŸá„áŸ‹á“áŸ… Rokar Yea' }},
  { year: locale === 'de' ? 'Heute' : locale === 'en' ? 'Today' : 'ááŸ’á„áŸƒá“áŸáŸ‡', title: { de: 'Mehr als 250 Kinder werden regelmÃ¤ÃŸig betreut', en: 'More than 250 children are regularly cared for', kh: 'á€á»á˜á¶ášá‡á¶á„ 250 á“á¶á€áŸ‹ááŸ’ášá¼áœá”á¶á“ááŸ‚ášá€áŸ’áŸá¶á‡á¶á‘áŸ€á„á‘á¶ááŸ‹' }}
];

const displayEvents = timelineEvents?.length > 0 ? timelineEvents : defaultEvents;
---

<Layout title={pageTitle} locale={locale}>
  <!-- Hero -->
  <section class="bg-gradient-to-br from-bamboo-700 to-bamboo-900 text-white py-20 md:py-28">
    <div class="container-custom px-4 md:px-8">
      <div class="max-w-3xl">
        <a href={localizedUrl('/', locale)} class="inline-flex items-center gap-2 text-bamboo-200 hover:text-white mb-6 transition-colors">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          {locale === 'de' ? 'ZurÃ¼ck zur Startseite' : locale === 'en' ? 'Back to home' : 'ááŸ’ášá¡á”áŸ‹á‘áŸ…á‘áŸ†á–áŸášáŠá¾á˜'}
        </a>
        <h1 class="text-4xl md:text-5xl font-heading font-bold mb-4">
          {t(historyPage?.pageTitle, locale) || (locale === 'de' 
            ? 'Kambodscha â€“ Ein Land mit Vergangenheit und Zukunft' 
            : locale === 'en'
            ? 'Cambodia â€“ A Country with Past and Future'
            : 'á€á˜áŸ’á–á»á‡á¶ â€“ á”áŸ’ášá‘áŸáŸá˜á½á™áŠáŸ‚á›á˜á¶á“á¢áá¸áá€á¶á› á“á·á„á¢á“á¶á‚á')}
        </h1>
        <div class="w-20 h-1 bg-khmer-500 rounded-full"></div>
      </div>
    </div>
  </section>

  <!-- Cambodia Background -->
  <section class="section bg-white">
    <div class="container-custom">
      <div class="max-w-4xl mx-auto prose prose-lg prose-bamboo">
        
        <!-- Geography -->
        <div class="mb-12">
          <h2 class="text-2xl md:text-3xl font-heading font-bold text-bamboo-800 mb-4">
            ğŸŒ {locale === 'de' ? 'Land & Lage' : locale === 'en' ? 'Location' : 'á‘á¸áá¶áŸ†á„'}
          </h2>
          <p class="text-earth-700 leading-relaxed">
            {t(historyPage?.cambodiaBackground?.geography, locale) || (locale === 'de'
              ? 'Kambodscha liegt im Herzen SÃ¼dostasiens, eingebettet zwischen Thailand, Laos und Vietnam. Mehr als 17 Millionen Menschen leben heute im Land, davon etwa 2,4 Millionen in der Hauptstadt Phnom Penh.'
              : locale === 'en'
              ? 'Cambodia lies in the heart of Southeast Asia, nestled between Thailand, Laos and Vietnam. More than 17 million people live in the country today, about 2.4 million of them in the capital Phnom Penh.'
              : 'á€á˜áŸ’á–á»á‡á¶áŸáŸ’áá·áá“áŸ…á…áŸ†á€ááŸ’áá¶á›á¢á¶áŸáŸŠá¸á¢á¶á‚áŸ’á“áŸá™áŸ ášáœá¶á„ááŸƒ á¡á¶áœ á“á·á„áœáŸ€ááá¶á˜áŸ” á˜á“á»áŸáŸ’áŸá‡á¶á„ 17 á›á¶á“á“á¶á€áŸ‹ášáŸáŸ‹á“áŸ…á€áŸ’á“á»á„á”áŸ’ášá‘áŸáŸá“áŸáŸ‡áŸ”')}
          </p>
        </div>

        <!-- History -->
        <div class="mb-12">
          <h2 class="text-2xl md:text-3xl font-heading font-bold text-bamboo-800 mb-4">
            ğŸ“œ {locale === 'de' ? 'Ein Land mit schwerer Geschichte' : locale === 'en' ? 'A Difficult History' : 'á”áŸ’ášáœááŸ’áá·áŸá¶áŸáŸ’ášáŸ’áá›áŸ†á”á¶á€'}
          </h2>
          <p class="text-earth-700 leading-relaxed mb-4">
            {t(historyPage?.cambodiaBackground?.history, locale) || (locale === 'de'
              ? 'Die Narben der Vergangenheit sind in Kambodscha bis heute spÃ¼rbar. Zwischen 1975 und 1979 herrschte das Terrorregime der Roten Khmer unter Pol Pot. SchÃ¤tzungen zufolge kamen dabei bis zu 2 Millionen Menschen ums Leben.'
              : locale === 'en'
              ? 'The scars of the past are still visible in Cambodia today. Between 1975 and 1979, the terror regime of the Khmer Rouge under Pol Pot ruled. An estimated 2 million people lost their lives.'
              : 'áŸáŸ’á“á¶á˜ášá”á½áŸá¢áá¸áá€á¶á›á“áŸ…ááŸ‚á˜á¾á›áƒá¾á‰á“áŸ…á€á˜áŸ’á–á»á‡á¶ááŸ’á„áŸƒá“áŸáŸ‡áŸ” ášáœá¶á„á†áŸ’á“á¶áŸ† 1975 á“á·á„ 1979 ášá”á”á—áŸá™ášá“áŸ’á’ááŸ‹ááŸ’á˜áŸ‚ášá€áŸ’ášá á˜á€áŸ’ášáŸ„á˜á”áŸ‰á»á› á–áá”á¶á“á€á¶á“áŸ‹á¢áŸ†áá¶á…áŸ”')}
          </p>
          <p class="text-earth-700 leading-relaxed">
            {locale === 'de'
              ? 'Schulen und KrankenhÃ¤user wurden zerstÃ¶rt, groÃŸe Teile der gebildeten BevÃ¶lkerung ausgelÃ¶scht â€“ etwa ein Viertel der damaligen BevÃ¶lkerung. Auch heute noch sind many Landregionen von den Folgen dieser Zeit geprÃ¤gt.'
              : locale === 'en'
              ? 'Schools and hospitals were destroyed, large parts of the educated population were wiped out â€“ about a quarter of the population at that time. Many rural areas are still affected by the consequences of this period today.'
              : 'áŸá¶á›á¶ášáŸ€á“ á“á·á„á˜á“áŸ’á‘á¸ášá–áŸá‘áŸ’á™ááŸ’ášá¼áœá”á¶á“á”áŸ†á•áŸ’á›á¶á‰áŸ” á”áŸ’ášá‡á¶á‡á“á˜á¶á“á€á¶ášá¢á”áŸ‹ášáŸ†á˜á½á™á—á¶á‚á’áŸ†ááŸ’ášá¼áœá”á¶á“á›á»á”á”áŸ†á”á¶ááŸ‹áŸ”'}
          </p>
        </div>

        <!-- Economy -->
        <div class="mb-12">
          <h2 class="text-2xl md:text-3xl font-heading font-bold text-bamboo-800 mb-4">
            ğŸ’¼ {locale === 'de' ? 'Zwischen Aufbruch und Armut' : locale === 'en' ? 'Between Progress and Poverty' : 'ášáœá¶á„áœáŒáŸ’áá“á—á¶á– á“á·á„á—á¶á–á€áŸ’ášá¸á€áŸ’áš'}
          </h2>
          <p class="text-earth-700 leading-relaxed">
            {t(historyPage?.cambodiaBackground?.economy, locale) || (locale === 'de'
              ? 'In den letzten zwei Jahrzehnten hat Kambodscha wirtschaftlich aufgeholt â€“ vor allem durch Textilindustrie, Bauwirtschaft und Tourismus zu den weltberÃ¼hmten Tempeln von Angkor Wat bei Siem Reap. Doch die Corona-Pandemie hat das Land wirtschaftlich stark getroffen.'
              : locale === 'en'
              ? 'In the last two decades, Cambodia has caught up economically â€“ mainly through the textile industry, construction and tourism to the world-famous temples of Angkor Wat near Siem Reap. However, the Corona pandemic hit the country hard economically.'
              : 'á€áŸ’á“á»á„ášá™áŸˆá–áŸá›á–á¸ášá‘áŸáœááŸ’áŸášáŸá€á“áŸ’á›á„á˜á€ á€á˜áŸ’á–á»á‡á¶á”á¶á“ášá¸á€á…á˜áŸ’ášá¾á“á•áŸ’á“áŸ‚á€áŸáŸáŠáŸ’á‹á€á·á…áŸ’á…áŸ” á”áŸ‰á»á“áŸ’ááŸ‚á‡áŸ†á„áºášá¶áááŸ’á”á¶áá€á¼ášáŸ‰á¼áá¶á”á¶á“á”áŸ‰áŸ‡á–á¶á›áŸ‹á”áŸ’ášá‘áŸáŸá™áŸ‰á¶á„ááŸ’á›á¶áŸ†á„áŸ”')}
          </p>
        </div>

        <!-- Education -->
        <div class="mb-12 bg-earth-100 rounded-2xl p-8">
          <h2 class="text-2xl md:text-3xl font-heading font-bold text-bamboo-800 mb-4">
            ğŸ“ {locale === 'de' ? 'Bildung ist keine SelbstverstÃ¤ndlichkeit' : locale === 'en' ? 'Education is Not a Given' : 'á€á¶ášá¢á”áŸ‹ášáŸ†á˜á·á“á˜áŸ‚á“á‡á¶ášá¿á„á’á˜áŸ’á˜áá¶á‘áŸ'}
          </h2>
          <p class="text-earth-700 leading-relaxed mb-4">
            {t(historyPage?.cambodiaBackground?.education, locale) || (locale === 'de'
              ? 'Obwohl Kambodscha ein staatliches Bildungssystem anbietet, ist Bildung gerade auf dem Land fÃ¼r viele Kinder nicht erreichbar oder nicht finanzierbar.'
              : locale === 'en'
              ? 'Although Cambodia offers a public education system, education is often not accessible or affordable for many children, especially in rural areas.'
              : 'á‘áŸ„áŸ‡á”á¸á‡á¶á€á˜áŸ’á–á»á‡á¶á•áŸ’áá›áŸ‹á”áŸ’ášá–áŸá“áŸ’á’á¢á”áŸ‹ášáŸ†áŸá¶á’á¶ášááŸˆ á€á¶ášá¢á”áŸ‹ášáŸ†á‡á¶ášá¿á™áŸ—á˜á·á“á¢á¶á…á‘á‘á½á›á”á¶á“áŸá˜áŸ’ášá¶á”áŸ‹á€á»á˜á¶ášá‡á¶á…áŸ’ášá¾á“ á‡á¶á–á·áŸáŸáŸá“áŸ…ááŸ†á”á“áŸ‹á‡á“á”á‘áŸ”')}
          </p>
          <ul class="space-y-2 text-earth-700">
            <li class="flex items-start gap-2">
              <span class="text-khmer-500">â€¢</span>
              {locale === 'de' ? 'Viele Kinder mÃ¼ssen frÃ¼h zum Lebensunterhalt der Familie beitragen' : locale === 'en' ? 'Many children must contribute to the family income early on' : 'á€á»á˜á¶ášá‡á¶á…áŸ’ášá¾á“ááŸ’ášá¼áœášá½á˜á…áŸ†ááŸ‚á€á€áŸ’á“á»á„á”áŸ’ášá¶á€áŸ‹á…áŸ†áá¼á›á‚áŸ’ášá½áŸá¶ášá–á¸áŠáŸ†á”á¼á„'}
            </li>
            <li class="flex items-start gap-2">
              <span class="text-khmer-500">â€¢</span>
              {locale === 'de' ? 'Oder auf kleinere Geschwister aufpassen' : locale === 'en' ? 'Or look after younger siblings' : 'á¬á˜á¾á›ááŸ‚á”áŸ’á¢á¼á“áŸ—'}
            </li>
            <li class="flex items-start gap-2">
              <span class="text-khmer-500">â€¢</span>
              {locale === 'de' ? 'Lange Schulwege ohne Transportmittel erschweren den Schulbesuch' : locale === 'en' ? 'Long school routes without transportation make school attendance difficult' : 'á•áŸ’á›á¼áœá‘áŸ…áŸá¶á›á¶ášáŸ€á“áœáŸ‚á„áŠáŸ„á™á‚áŸ’á˜á¶á“á€á¶ášáŠá¹á€á‡á‰áŸ’á‡á¼á“'}
            </li>
          </ul>
          <div class="mt-6 p-4 bg-khmer-50 border-l-4 border-khmer-500 rounded-r-lg">
            <p class="text-khmer-800 font-medium">
              {locale === 'de' 
                ? 'ğŸ‘‰ Besonders betroffen sind die DÃ¶rfer rund um Siem Reap â€“ dort leben Ã¼ber 50% der BevÃ¶lkerung unter der Armutsgrenze von rund 2$ am Tag.'
                : locale === 'en'
                ? 'ğŸ‘‰ Villages around Siem Reap are particularly affected â€“ over 50% of the population there lives below the poverty line of about $2 a day.'
                : 'ğŸ‘‰ á—á¼á˜á·á‡á»áŸ†áœá·á‰áŸáŸ€á˜ášá¶á”ááŸ’ášá¼áœá”á¶á“á”áŸ‰áŸ‡á–á¶á›áŸ‹á‡á¶á–á·áŸáŸáŸ â€“ á”áŸ’ášá‡á¶á‡á“á‡á¶á„ 50% ášáŸáŸ‹á“áŸ…á€áŸ’ášáŸ„á˜á”á“áŸ’á‘á¶ááŸ‹á—á¶á–á€áŸ’ášá¸á€áŸ’ášáŸ”'}
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Bamboo Shoots Timeline -->
  <section class="section bg-earth-100">
    <div class="container-custom">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-heading font-bold text-bamboo-800 mb-4">
            ğŸŒ± {locale === 'de' ? 'Unsere Geschichte' : locale === 'en' ? 'Our History' : 'á”áŸ’ášáœááŸ’áá·ášá”áŸáŸ‹á™á¾á„'}
          </h2>
          <p class="text-earth-600">
            {locale === 'de' 
              ? 'Bamboo Shoots â€“ Eine wachsende Vision seit 2003'
              : locale === 'en'
              ? 'Bamboo Shoots â€“ A growing vision since 2003'
              : 'Bamboo Shoots â€“ á…á€áŸ’áá»áœá·áŸáŸá™áŠáŸ‚á›á€áŸ†á–á»á„ášá¸á€á…á˜áŸ’ášá¾á“á…á¶á”áŸ‹áá¶áŸ†á„á–á¸á†áŸ’á“á¶áŸ† 2003'}
          </p>
        </div>

        <!-- Timeline -->
        <div class="relative">
          {displayEvents.map((event, index) => (
            <div class="timeline-item">
              <div class="timeline-dot"></div>
              <div class="bg-white rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow">
                <span class="inline-block bg-bamboo-100 text-bamboo-700 font-bold px-3 py-1 rounded-full text-sm mb-2">
                  {event.year}
                </span>
                <h3 class="text-lg font-heading font-semibold text-earth-800">
                  {t(event.title, locale)}
                </h3>
                {event.description && (
                  <p class="text-earth-600 mt-2 text-sm">
                    {t(event.description, locale)}
                  </p>
                )}
              </div>
            </div>
          ))}
        </div>

        <!-- Back to home -->
        <div class="text-center mt-12">
          <a href={localizedUrl('/', locale)} class="btn-primary">
            {locale === 'de' ? 'â† ZurÃ¼ck zur Startseite' : locale === 'en' ? 'â† Back to Home' : 'â† ááŸ’ášá¡á”áŸ‹á‘áŸ…á‘áŸ†á–áŸášáŠá¾á˜'}
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>
