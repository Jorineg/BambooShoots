---
import { t, type Locale } from '../../lib/i18n';
import { urlFor } from '../../lib/sanity';

interface Props {
  locale: Locale;
  programs: any[];
}

const { locale, programs } = Astro.props;

// Default programs if none from Sanity
const defaultPrograms = [
  {
    icon: 'ðŸ‘¶',
    title: { de: 'Vorschule & Bildung', en: 'Preschool & Education', kh: 'áž˜ážáŸ’ážáŸáž™áŸ’áž™ áž“áž·áž„áž€áž¶ážšáž¢áž”áŸ‹ážšáŸ†' },
    description: { 
      de: 'FrÃ¼hfÃ¶rderung ist der erste Schritt in eine bessere Zukunft. Wir betreiben Vorschulen in abgelegenen DÃ¶rfern rund um Siem Reap.',
      en: 'Early childhood education is the first step to a better future. We operate preschools in remote villages around Siem Reap.',
      kh: 'áž€áž¶ážšáž¢áž”áŸ‹ážšáŸ†áž€áž»áž˜áž¶ážšáž—áž¶áž–ážŠáŸ†áž”áž¼áž„áž‚ážºáž‡áž¶áž‡áŸ†áž áž¶áž“ážŠáŸ†áž”áž¼áž„áž‘áŸ…áž€áž¶áž“áŸ‹áž¢áž“áž¶áž‚ážáž›áŸ’áž¢áž”áŸ’ážšážŸáž¾ážšáŸ”'
    },
    features: [
      { de: 'Altersgerechter Unterricht', en: 'Age-appropriate teaching', kh: 'áž€áž¶ážšáž”áž„áŸ’ážšáŸ€áž“ážŸáž˜ážŸáŸ’ážšáž”ážáž¶áž˜áž¢áž¶áž™áž»' },
      { de: 'Hygienische Erziehung', en: 'Hygiene education', kh: 'áž€áž¶ážšáž¢áž”áŸ‹ážšáŸ†áž¢áž“áž¶áž˜áŸáž™' },
      { de: 'TÃ¤glich warme Mahlzeit', en: 'Daily warm meal', kh: 'áž¢áž¶áž áž¶ážšáž€áŸ’ážáŸ…áž”áŸ’ážšáž…áž¶áŸ†ážáŸ’áž„áŸƒ' },
      { de: 'Integration aller Kinder', en: 'Inclusion of all children', kh: 'áž€áž¶ážšážŠáž¶áž€áŸ‹áž”áž‰áŸ’áž…áž¼áž›áž€áž»áž˜áž¶ážšáž‘áž¶áŸ†áž„áž¢ážŸáŸ‹' }
    ]
  },
  {
    icon: 'ðŸ“š',
    title: { de: 'NachmittagsfÃ¶rderung', en: 'Afternoon Support', kh: 'áž€áž¶ážšáž‚áž¶áŸ†áž‘áŸ’ážšáž–áŸáž›ážšážŸáŸ€áž›' },
    description: {
      de: 'FÃ¼r Schulkinder bieten wir Nachmittagskurse in Khmer, Englisch und Mathematik an â€“ fÃ¼r viele Kinder die einzige MÃ¶glichkeit, eine Fremdsprache zu lernen.',
      en: 'For school children we offer afternoon courses in Khmer, English and Mathematics â€“ for many children the only opportunity to learn a foreign language.',
      kh: 'ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž€áž»áž˜áž¶ážšážŸáž¶áž›áž¶ áž™áž¾áž„áž•áŸ’ážáž›áŸ‹ážœáž‚áŸ’áž‚ážŸáž·áž€áŸ’ážŸáž¶áž–áŸáž›ážšážŸáŸ€áž›áž‡áž¶áž—áž¶ážŸáž¶ážáŸ’áž˜áŸ‚ážš áž¢áž„áŸ‹áž‚áŸ’áž›áŸážŸ áž“áž·áž„áž‚ážŽáž·ážážœáž·áž‘áŸ’áž™áž¶áŸ”'
    },
    features: [
      { de: 'Kinder 6â€“17 Jahre', en: 'Children aged 6â€“17', kh: 'áž€áž»áž˜áž¶ážšáž¢áž¶áž™áž» 6-17 áž†áŸ’áž“áž¶áŸ†' },
      { de: 'Kambodschanische Lehrer:innen', en: 'Cambodian teachers', kh: 'áž‚áŸ’ážšáž¼áž”áž„áŸ’ážšáŸ€áž“áž€áž˜áŸ’áž–áž»áž‡áž¶' },
      { de: 'Individuell und motivierend', en: 'Individual and motivating', kh: 'áž”áž»áž‚áŸ’áž‚áž› áž“áž·áž„áž›áž¾áž€áž‘áž¹áž€áž…áž·ážáŸ’áž' }
    ]
  },
  {
    icon: 'ðŸ“–',
    title: { de: 'Bibliothek', en: 'Library', kh: 'áž”ážŽáŸ’ážŽáž¶áž›áŸáž™' },
    description: {
      de: 'Die Bibliothek ist mehr als ein Lernort: Sie ist ein Treffpunkt, Leseraum und ein sicherer Ort zum Wachsen.',
      en: 'The library is more than a learning place: It is a meeting point, reading room and a safe space to grow.',
      kh: 'áž”ážŽáŸ’ážŽáž¶áž›áŸáž™áž‚ážºáž…áŸ’ážšáž¾áž“áž‡áž¶áž„áž€áž“áŸ’áž›áŸ‚áž„ážšáŸ€áž“áŸ– ážœáž¶áž‡áž¶áž…áŸ†ážŽáž»áž…áž‡áž½áž”áž‡áž»áŸ† áž”áž“áŸ’áž‘áž”áŸ‹áž¢áž¶áž“ áž“áž·áž„áž€áž“áŸ’áž›áŸ‚áž„ážŸáž»ážœážáŸ’ážáž·áž—áž¶áž–ážŠáž¾áž˜áŸ’áž”áž¸ážšáž¸áž€áž…áž˜áŸ’ážšáž¾áž“áŸ”'
    },
    features: [
      { de: 'LeihbÃ¼cher fÃ¼r alle Altersgruppen', en: 'Books for all ages', kh: 'ážŸáŸ€ážœáž—áŸ…ážŸáž˜áŸ’ážšáž¶áž”áŸ‹áž‚áŸ’ážšáž”áŸ‹áž¢áž¶áž™áž»' },
      { de: 'Kreative FÃ¶rderung durch Basteln', en: 'Creative activities', kh: 'ážŸáž€áž˜áŸ’áž˜áž—áž¶áž–áž…áŸ’áž“áŸƒáž”áŸ’ážšážŒáž·áž' },
      { de: 'Themenreihen: Hygiene, Umgang mit Geld', en: 'Themed series: Hygiene, money management', kh: 'ážŸáŸŠáŸážšáž¸áž”áŸ’ážšáž’áž¶áž“áž”áž‘' }
    ]
  },
  {
    icon: 'ðŸ§¡',
    title: { de: 'Hilfe fÃ¼r die Gemeinschaft', en: 'Community Support', kh: 'áž€áž¶ážšáž‚áž¶áŸ†áž‘áŸ’ážšážŸáž áž‚áž˜áž“áŸ' },
    description: {
      de: 'Wir unterstÃ¼tzen die Familien auch in Notsituationen. Hilfe zur Selbsthilfe.',
      en: 'We also support families in emergency situations. Help for self-help.',
      kh: 'áž™áž¾áž„áž€áŸáž‚áž¶áŸ†áž‘áŸ’ážšáž‚áŸ’ážšáž½ážŸáž¶ážšáž€áŸ’áž“áž»áž„ážŸáŸ’ážáž¶áž“áž—áž¶áž–áž”áž“áŸ’áž‘áž¶áž“áŸ‹áŸ”'
    },
    features: [
      { de: 'Moskitonetze & FahrrÃ¤der', en: 'Mosquito nets & bicycles', kh: 'áž˜áž»áž„áž‚áŸ’ážšáŸ‚áž”áž¶áž‰áŸ‹ áž“áž·áž„áž€áž„áŸ‹' },
      { de: 'Reis- und Hygienepakete', en: 'Rice and hygiene packages', kh: 'áž€áž‰áŸ’áž…áž”áŸ‹áž¢áž„áŸ’áž€ážš áž“áž·áž„áž¢áž“áž¶áž˜áŸáž™' },
      { de: 'Hausbesuche & Beratung', en: 'Home visits & consultation', kh: 'áž‘ážŸáŸ’ážŸáž“áž¶áž•áŸ’áž‘áŸ‡ áž“áž·áž„áž–áž·áž‚áŸ’ážšáŸ„áŸ‡áž™áŸ„áž”áž›áŸ‹' },
      { de: 'Bildung fÃ¼r Erwachsene', en: 'Adult education', kh: 'áž€áž¶ážšáž¢áž”áŸ‹ážšáŸ†áž˜áž“áž»ážŸáŸ’ážŸáž–áŸáž‰ážœáŸáž™' }
    ]
  }
];

const displayPrograms = programs?.length > 0 ? programs : defaultPrograms;
---

<section id="programme" class="section bg-bamboo-50">
  <div class="container-custom">
    <!-- Section header -->
    <div class="text-center mb-16 md:mb-24">
      <h2 class="text-3xl md:text-5xl font-heading font-bold text-bamboo-800 mb-8">
        {locale === 'de' ? 'Unsere Programme' : locale === 'en' ? 'Our Programs' : 'áž€áž˜áŸ’áž˜ážœáž·áž’áž¸ážšáž”ážŸáŸ‹áž™áž¾áž„'}
      </h2>
    </div>

    <!-- Program cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 lg:gap-16">
      {displayPrograms.map((program, index) => (
        <div class="group flex flex-col h-full bg-white rounded-[2rem] overflow-hidden border border-earth-100 hover:border-bamboo-200 hover:shadow-2xl transition-all duration-500" style={`animation-delay: ${index * 0.1}s`}>
          <!-- Image Header -->
          <div class="aspect-[16/9] overflow-hidden relative">
            {program.image ? (
              <img 
                src={urlFor(program.image).width(800).height(450).url()} 
                alt={t(program.title, locale)}
                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
              />
            ) : (
              <div class="w-full h-full bg-bamboo-50 flex items-center justify-center">
                <span class="text-6xl group-hover:scale-110 transition-transform duration-500 opacity-20">{program.icon}</span>
              </div>
            )}
            <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
          </div>

          <div class="p-8 md:p-10 flex flex-col flex-grow">
            <!-- Icon & Title (Fixed Gap) -->
            <div class="flex items-center gap-3 mb-6">
              <span class="text-2xl group-hover:scale-110 transition-transform duration-300">{program.icon}</span>
              <h3 class="text-2xl md:text-3xl font-heading font-bold text-bamboo-900 leading-tight">
                {t(program.title, locale)}
              </h3>
            </div>

            <!-- Description -->
            <p class="text-earth-600 text-lg mb-8 leading-relaxed">
              {t(program.description, locale)}
            </p>

            <!-- Features list -->
            {program.features && (
              <ul class="space-y-4 mt-auto">
                {program.features.map((feature: any) => (
                  <li class="flex items-start gap-3 text-earth-700">
                    <div class="mt-1 flex-shrink-0 w-5 h-5 rounded-full bg-khmer-50 flex items-center justify-center">
                      <svg class="w-3 h-3 text-khmer-600" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                      </svg>
                    </div>
                    <span class="text-sm font-medium">{t(feature, locale)}</span>
                  </li>
                ))}
              </ul>
            )}
          </div>
        </div>
      ))}
    </div>
  </div>
</section>
